<html>
<head>
  <meta charset="utf-8">
  <!--<meta http-equiv="refresh" content="22" > -->

  <!--ADD ALL CSS STYLE-SHEETS -->

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/css/materialize.min.css">
  {% assets "main_css" %}

  <link rel=stylesheet type=text/css href="{{ASSET_URL}}">
    <link rel=stylesheet type=text/css href="static/progress.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  {%endassets%}

  <!--ADD ALL JAVASCRIPTS ##BUNDLED INTO ONE FILE-->

  {% assets "main_js" %}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.8/socket.io.min.js"></script>
  <script type="text/javascript" src="{{ASSET_URL}}" > </script>
  <script type="text/javascript" src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="q35o4p01rr1byor"></script>
<script src="static/api.js"> </script>
<script src="https://www.google.com/jsapi?key=AIzaSyDTpfIEYydGLzzhKRrm41LaqFssZLiqsjU"></script>
<script src="https://apis.google.com/js/client.js?onload=initPicker"></script>
	<script src="static/filepicker.js"></script>

  {%endassets%}


</head>
<body class='blue-grey lighten-4'>

<nav>
<div class="nav-wrapper grey lighten-4">
    <p class="blue-grey-text text-lighten-2">
<i class="fas fa-file-archive fa-3x"> Compress it!</i>

</p>
</div>

</nav>

<div class="row">
   <!-- <div class="col s12 m4 l2"><h3>Compress it online</h3></div> -->
   <div class="col s12"><p></p></div>
   <div class="col s12 m4 l2"></div>

   <div class="col s12 m4 l10">
     <div  id="drop-zone">
       <div class="row">
         <div class="col s12 m6 l10">
           <div class="card blue-grey darken-1">
             <div class="card-content white-text">
               <span class="card-title">
                 <i class="fas fa-file-medical fa-2x"> </i>
                 Compress Dicom Files
               </span>
               <form class="uploadform"  name="upload" method="POST" action="{{ url_for('downloader') }}" enctype = "multipart/form-data">

                 </div>

               <button disabled type="submit"  name="submit" class="btn-floating halfway-fab waves-effect waves-light red" id="js-upload-submit" onclick="this.disabled=true;">
                 <i class="fas fa-file-download"> </i>

               </button>

                 </form>

               <div  id="drop-zone">
               <form class="dropzone dz-clickable" id="mydropzone" name='file' action="{{ url_for('uploader') }}" enctype = "multipart/form-data">
               <span>

               <i id="auth" class="fab fa-dropbox " onclick="Dropbox.choose(options)" style="color:rgb(0,0,0)" onchange="Button_Enable()">Dropbox</i> </g>

               </span>

               <span>
               <br/>
               <br/>
               <i id="pick" class="fab fa-google-drive " onclick="newPicker()" style="color:rgb(0,0,0)">Google Drive</i>

               </span>



               </form>
               <progress id="total" name="total" max="100" value="0">

 </progress>
               <div id='change'>

            </div>
             </div>
              <div class="card-action">

           </div>
         </div>
       </div>
      </div>

     </div>

  </div>


  <script>
$(document).ready(function(){

  var socket = io.connect('http://127.0.0.1:5000');


  socket.on('message',function(msg){
    var criteria=msg

    document.getElementById("change").innerHTML = "<i>"+msg+"%</i>";

    console.log('Recieved msg');
      $("#total").val(msg)

      $("#js-upload-submit").removeAttr('disabled')
      $("#js-upload-submit").css({
        "cursor": "pointer",
        "box-shadow": "1px 0px 6px #333"
      });


  });
});

  </script>




	<script>

	</script>




</script>



</div>

        <footer class="page-footer grey">
          <div class="container">
            <div class="row">
              <div class="col l6 s12">

                <p class="grey-text text-darken-4">
                  <a class="grey-text text-darken-4" href="{{ url_for('script_download') }}" > Wish to convert it back to .dcm? Download our simple python script</a>
                </p>
                <form action={{ url_for('script_download') }}>
                  <button type="submit"  name="submit" class="btn waves-effect waves-light" id="js-upload-submit" >
                    <i class="fas fa-file-code fa-7x"> Download script</i>

                  </button>
                </form>

              </div>


        </footer>
        <div class="footer-copyright grey">
          <div class="container">
          Â© 2018 Copyright Text
          <a class="grey-text text-darken-4 right" href="#!">More Links</a>
          </div>
        </div>

</body>

</html>
